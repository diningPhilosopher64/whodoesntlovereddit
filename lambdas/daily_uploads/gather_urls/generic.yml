function:
  memorySize: 512
  image:
    name: daily_uploads
    command: 
      - daily_uploads.gather_urls.run
  events:
    - sqs: 
        arn: ${self:custom.DailyUploadsGatherPostsForASubredditQueue.arn}
        batchSize: 1

  iamRoleStatementsName: RedditAccountsTable-get
  iamRoleStatements:
    - Effect: "Allow"
      Action:
        - sqs:ReceiveMessage
      Resource:
        - ${self:custom.DailyUploadsGatherPostsForASubredditQueue.arn}

    - Effect: "Allow"
      Action:
        - dynamodb:GetItem
      Resource:
        - ${self:custom.RedditAccountsTable.arn}

    - Effect: "Allow"
      Action:
        - dynamodb:GetItem
        - dynamodb:PutItem
        - dynamodb:Scan
      Resource:
        - ${self:custom.DailyUploadsTable.arn}
      
    - Effect: "Allow"
      Action:
        - sqs:SendMessage
      Resource:
        - ${self:custom.DailyUploadsProcessPostsForASubredditQueue.arn}